<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="쉼표샵에서 만들어진 높은 퀄리티를 자랑하는 상품을 구매하세요.">
    <meta name="robots" content="max-image-preview:large">
    <title>쉼표샵 상품 | shmpyo#</title>
    <link href="./IMg/쉼표샵로고.png" rel="shortcut icon" type="image/x-icon">
    <link rel="canonical" href="https://shmpyoshop.netlify.app/">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="쉼표샵 shmpyo#">
    <meta property="og:type" content="website">
    <meta property="og:title" content="쉼표샵 상품 - 쉼표샵 공식 홈페이지">
    <meta property="og:description" content="쉼표샵에서 만들어진 높은 퀄리티를 자랑하는 상품을 구매하세요.">
    <meta property="og:url" content="https://shmpyoshop.netlify.app/">
    <meta property="og:image" content="https://media.discordapp.net/attachments/1193969295881933010/1284363066175131701/660510020f1c7f4d.png?ex=66e65bd1&is=66e50a51&hm=e3ae295b17cdcd2a3a707a1c37cb568b5f9308580cfa8d37a639a2c43e2fc61a&=&format=webp&quality=lossless">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="쉼표샵 로고">    

    <meta name="twitter:site" content="https://shmpyoshop.netlify.app/">
    <meta name="twitter:title" content="쉼표샵 상품 - 쉼표샵 공식 홈페이지">
    <meta name="twitter:description" content="쉼표샵에서 만들어진 높은 퀄리티를 자랑하는 상품을 구매하세요.">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:src" content="https://media.discordapp.net/attachments/1193969295881933010/1284363066175131701/660510020f1c7f4d.png?ex=66e65bd1&is=66e50a51&hm=e3ae295b17cdcd2a3a707a1c37cb568b5f9308580cfa8d37a639a2c43e2fc61a&=&format=webp&quality=lossless">
    <link rel="stylesheet" href="/project/payment/success.css"/>
    <script src="https://js.tosspayments.com/v2/standard"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <div id="header-container"></div>

    <div class="info_1_section">
        <div>
            <div class="loader"></div>
            <div class="h1">결제 진행 중이에요</div>
            <div class="p">결제 진행은 최대 1~2분 소요될 수 있어요</div>
        </div>
    </div>

    <iframe 
        src="/footer.html" 
        style="width: 100%; height: 250px; border: none;">
    </iframe>

    <script src="./Js/scrollTop.js"></script>

    <script>
        fetch('/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
            });
    </script>
    
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const paymentKey = urlParams.get("paymentKey");
        const orderId = urlParams.get("orderId");
        const amount = urlParams.get("amount");


        async function confirm() {
        const requestData = {
            paymentKey: paymentKey,
            orderId: orderId,
            amount: amount,
        };

        const response = await fetch("/confirm", {
            method: "POST",
            headers: {
            "Content-Type": "application/json",
            },
            body: JSON.stringify(requestData),
        });

        const json = await response.json();

        if (!response.ok) {
            // 결제 실패 비즈니스 로직을 구현하세요.
            console.log(json);
            window.location.href = `/fail?message=${json.message}&code=${json.code}`;
        }

        // 결제 성공 비즈니스 로직을 구현하세요.
        console.log(json);
        }
        confirm();

        // const paymentKeyElement = document.getElementById("paymentKey");
        // const orderIdElement = document.getElementById("orderId");
        // const amountElement = document.getElementById("amount");

        // orderIdElement.textContent = "주문번호: " + orderId;
        // amountElement.textContent = "결제 금액: " + amount;
        // paymentKeyElement.textContent = "paymentKey: " + paymentKey;
    </script>
      
</body>
</html>
