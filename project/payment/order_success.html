<!DOCTYPE html>
<html lang="ko">
<head>
    <title>결제 완료 | shmpyoshop</title>
    <link rel="stylesheet" href="/project/payment/order.css"/>



    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="간편하게, 똑똑하게! 손쉽게 완성하는 나를 위한 시스템을 쉼표샵에서 만나보세요.">
    <meta name="robots" content="max-image-preview:large">
    <link href="/IMG/파비콘.svg" rel="shortcut icon" type="image/x-icon">
    <link rel="canonical" href="https://www.shmpyoshop.com/home">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="쉼표샵 shmpyo#">
    <meta property="og:type" content="website">
    <meta property="og:title" content="쉼표샵 - 공식 홈페이지">
    <meta property="og:description" content="간편하게, 똑똑하게! 손쉽게 완성하는 나를 위한 시스템을 쉼표샵에서 만나보세요.">
    <meta property="og:url" content="https://www.shmpyoshop.com/home">
    <meta property="og:image" content="https://media.discordapp.net/attachments/1282189604803444830/1342507726852587580/7d134f0e74b599b0.png?ex=67b9e340&is=67b891c0&hm=6904e632e03d87dbba50a57a111c489a7739896954bfe1a0694361aa5689c343&=&format=webp&quality=lossless">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="쉼표샵 로고">    

    <meta name="twitter:site" content="https://www.shmpyoshop.com/home">
    <meta name="twitter:title" content="쉼표샵 - 공식 홈페이지">
    <meta name="twitter:description" content="간편하게, 똑똑하게! 손쉽게 완성하는 나를 위한 시스템을 쉼표샵에서 만나보세요.">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:src" content="https://media.discordapp.net/attachments/1282189604803444830/1342507726852587580/7d134f0e74b599b0.png?ex=67b9e340&is=67b891c0&hm=6904e632e03d87dbba50a57a111c489a7739896954bfe1a0694361aa5689c343&=&format=webp&quality=lossless">
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
</head>
<body>

    <div id="header-container"></div>
    <div id="loadingPopup" class="popup-overlay">
        <div class="popup-container">
            <div class="info_1_section_ov">
                <div class="loader"></div>
                <div class="h11">결제 진행 중이에요</div>
                <div class="pp">1분 내로 마무리할 수 있도록<br>열심히 결제 진행 중이에요.</div>
            </div>
        </div>
    </div>
    <div class="block"></div>
    <div class="info_1_section">
        <div>

            <div class="load_check"></div>

            <lottie-player class="success_icon"
                src="/IMG/check.json"
                background="transparent"
                speed="1">
            </lottie-player>


            <div class="h1">결제가 완료됐어요</div>
            <div class="p">비밀 코드는 카카오톡을 통해 전달해 드렸어요.</div>
            <div class="flex start">
                <div class="section_one">
                    <img class="img_pro" id="image" src="/IMG/product_img/상품준비.png">
                    <div class="inline">
                        <div id="h1_pro" class="h1_pro">test</div>
                        <div id="price_pro" class="price_pro">3원</div>
                    </div>
                </div>

                <div class="pill-badge">결제 완료</div>

            </div>
            <hr>
            <div class="flex">
                <div class="section_two start">
                    <div class="p_pro_one">이름</div>
                    <div class="p_pro_one">전화번호</div>
                    <div class="p_pro_one">주문번호</div>
                </div>
                <div class="section_two">
                    <div id="name" class="p_pro_two">test</div>
                    <div id="phone" class="p_pro_two">test</div>
                    <div id="order_id" class="p_pro_two">tset</div>
                </div>
            </div>

            <button class="button" id="registerBtn" onclick="window.location.href='https://www.shmpyoshop.com/project/add/goods-code';">
                비밀 코드 활성화 신청하기
                <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7.40741 5.48333H0.158325V4.22917H7.40741L4.0846 0.906355L4.98541 0L9.84166 4.85625L5.01458 9.68333L4.11376 8.77698L7.40741 5.48333Z" fill="#3485FF"/>
                </svg>
            </button>
            
        </div>
    </div>

    <iframe src="/footer.html" style="width: 100%; height: 250px; max-height: 250px; border: none; overflow: hidden;"></iframe>
    <script>
        document.querySelector('lottie-player').addEventListener('ready', () => {
            document.querySelector('.load_check').style.display = 'none';
        });

    </script>
    
    <script>
        document.body.style.overflow = "hidden";
        const urlParams = new URLSearchParams(window.location.search);
        const paymentKey = urlParams.get("paymentKey");
        const orderId = urlParams.get("orderId");
        const amount = urlParams.get("amount");
        const orderName = urlParams.get("orderName");
        const productId = urlParams.get("productId");
        const userName = urlParams.get("customerName");
        const userphone = urlParams.get("customerPhone");
        const coupon = urlParams.get("coupon");
        const roblox = urlParams.get("roblox");

        async function confirm() {
            const requestData = {
                paymentKey: paymentKey,
                orderId: orderId,
                amount: amount,
                orderName: orderName,
                productId: productId,
                userName: userName,
                userphone: userphone,
                coupon: coupon,
                roblox: roblox
            };

            const response = await fetch("/confirm", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(requestData),
            });

            const json = await response.json();

            if (!response.ok) {
                console.log(json);
                window.location.href = `/project/payment/order_fail.html?message=${json.message}&code=${json.code}&amount=${amount}&name=${orderName}&ordercode=${productId}`;
            } else {
                document.body.style.overflow = "auto";
                document.getElementById("loadingPopup").style.display = "none";
                document.querySelector('.info_1_section').classList.add('success');
                document.querySelector('.block').classList.add('success');
                document.querySelector('lottie-player').play()
            }
            console.log(json);
        }
        confirm();

        const paymentKeyElement = document.getElementById("name");
        const orderIdElement = document.getElementById("order_id");
        const amountElement = document.getElementById("price_pro");
        const orderNameElement = document.getElementById("h1_pro");
        const imageElement = document.getElementById("image");
        const phoneElement = document.getElementById("phone");
        const formattedPrice = parseInt(amount).toLocaleString() + '원';

        orderIdElement.textContent = orderId;
        phoneElement.textContent = userphone
        amountElement.textContent = formattedPrice;
        paymentKeyElement.textContent = userName;
        orderNameElement.textContent = orderName
        imageElement.src = `/IMG/product_img/${productId}.png`;
    </script>
    
    <script src="/Js/scrollTop.js"></script>

    <script>
        fetch('/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
            });
    </script>
</body>
</html>
